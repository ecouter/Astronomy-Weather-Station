import { Button, VerticalBox, HorizontalBox } from "std-widgets.slint";

export component MainWindow inherits Window {
    title: "Weather Station Frontend";
    width: 1280px;
    height: 720px;
    preferred-width: 1200px;
    preferred-height: 800px;

    in property <bool> loading;
    in property <string> error_message;
    in property <image> top_left_image;
    in property <image> top_right_image;
    in property <image> bottom_left_image;
    in property <image> bottom_right_image;
    in property <image> legend_image;
    in property <image> cloud_cover_image;
    in property <string> cloud_cover_counter;
    in property <image> map_image;
    in property <image> cleardarksky_image;

    HorizontalBox {
        // Left side: Cloud cover prediction (top portion, 1/3 width)
        padding-left: 35px;
        VerticalBox {
            width: 400px; // 1/3 of 1200

            // Title
            Text {
                text: "RAW HRDPS cloud cover prediction";
                color: #ffffff;
                font-size: 16px;
                font-weight: 600;
                horizontal-alignment: center;
                vertical-alignment: top;
                height: 25px;
            }

            // Cloud cover section (top 60% of left side)
            Rectangle {
                height: 225px; // 60% of left side height

                if (loading) : Text {
                    text: "Loading cloud cover...";
                    horizontal-alignment: center;
                    vertical-alignment: center;
                    y: 25px;
                }

                if (!loading && error_message == "") : Rectangle {
                    width: 100%;
                    height: 100%;

                    // Map background image
                    Image {
                        source: map_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Cloud cover image (overlaid with alpha)
                    Image {
                        source: cloud_cover_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                        opacity: 80%;
                    }

                    // Red dot at center (coordinate location)
                    Rectangle {
                        width: 4px;
                        height: 4px;
                        background: #ff0000;
                        border-radius: 4px;
                        x: (parent.width - 4px) / 2;
                        y: (parent.height - 4px) / 2;
                    }

                    // Counter overlay
                    Text {
                        text: cloud_cover_counter;
                        color: #0066cc;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }
                }

                if (!loading && error_message != "") : Text {
                    text: error_message;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                    color: #ff0000;
                    y: 25px;
                }
            }
        }

        // Right side: weather images and bottom area (2/3 width)
        VerticalBox {
            width: 800px; // 2/3 of 1200

            // Top 2/3: 2x2 grid of weather images
            VerticalBox {
                height: 533px; // 2/3 of 800

                // Top row
                HorizontalBox {
                    height: 50%;

                    // Top-left: GOES-East_1km_VisibleIRSandwich-NightMicrophysicsIR
                    Rectangle {
                        width: 50%;

                        if (loading) : Text {
                            text: "Loading...";
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }

                        if (!loading && error_message == "") : Image {
                            source: top_left_image;
                            width: 100%;
                            height: 100%;
                            image-fit: fill;
                        }

                        // Red dot at center (coordinate location)
                        Rectangle {
                            width: 4px;
                            height: 4px;
                            background: #ff0000;
                            border-radius: 4px;
                            x: (parent.width - 4px) / 2;
                            y: (parent.height - 4px) / 2;
                        }

                        if (!loading && error_message != "") : Text {
                            text: error_message;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                            color: #ff0000;
                        }
                    }

                    // Top-right: GOES-East_2km_NightMicrophysics
                    Rectangle {
                        width: 50%;

                        if (loading) : Text {
                            text: "Loading...";
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }

                        if (!loading && error_message == "") : Image {
                            source: top_right_image;
                            width: 100%;
                            height: 100%;
                            image-fit: fill;
                        }

                        // Red dot at center (coordinate location)
                        Rectangle {
                            width: 4px;
                            height: 4px;
                            background: #ff0000;
                            border-radius: 4px;
                            x: (parent.width - 4px) / 2;
                            y: (parent.height - 4px) / 2;
                        }

                        if (!loading && error_message != "") : Text {
                            text: error_message;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                            color: #ff0000;
                        }
                    }
                }

                // Bottom row
                HorizontalBox {
                    height: 50%;

                    // Bottom-left: GOES-East_1km_NaturalColor
                    Rectangle {
                        width: 50%;

                        if (loading) : Text {
                            text: "Loading...";
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }

                        if (!loading && error_message == "") : Image {
                            source: bottom_left_image;
                            width: 100%;
                            height: 100%;
                            image-fit: fill;
                        }

                        // Red dot at center (coordinate location)
                        Rectangle {
                            width: 4px;
                            height: 4px;
                            background: #ff0000;
                            border-radius: 4px;
                            x: (parent.width - 4px) / 2;
                            y: (parent.height - 4px) / 2;
                        }

                        if (!loading && error_message != "") : Text {
                            text: error_message;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                            color: #ff0000;
                        }
                    }

                    // Bottom-right: HRDPS.CONTINENTAL_PN-SLP (blended) with legend overlaid
                    Rectangle {
                        width: 50%;

                        if (loading) : Text {
                            text: "Loading...";
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }

                        if (!loading && error_message == "") : Rectangle {
                            width: 100%;
                            height: 100%;

                            // Map background image
                            Image {
                                source: map_image;
                                width: 100%;
                                height: 100%;
                                image-fit: fill;
                            }

                            // Main image
                            Image {
                                source: bottom_right_image;
                                width: 100%;
                                height: 100%;
                                image-fit: fill;
                                opacity: 60%;
                            }

                            // Legend overlaid on bottom-right
                            Image {
                                source: legend_image;
                                width: 100%;
                                height: 100%;
                                x: parent.width * 0.42;
                                y: parent.height * 0;
                                image-fit: contain;
                            }

                            // Red dot at center (coordinate location)
                            Rectangle {
                                width: 4px;
                                height: 4px;
                                background: #ff0000;
                                border-radius: 4px;
                                x: (parent.width - 4px) / 2;
                                y: (parent.height - 4px) / 2;
                            }
                        }

                        if (!loading && error_message != "") : Text {
                            text: error_message;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                            color: #ff0000;
                        }
                    }
                }
                // Bottom portion (40% of left side) - available for future use
                // Bottom section: ClearDarkSky chart
                Rectangle {
                    height: 150px;
                
                    if (!loading && error_message == "") : Image {
                        source: cleardarksky_image;
                        width: 100%;
                        height: 100%;
                        image-fit: contain;
                    }
                
                    if (!loading && error_message != "") : Text {
                        text: error_message;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                        color: #ff0000;
                    }
                }
            }

            // Bottom 1/3: blank for now
            Rectangle {
                height: 267px; // 1/3 of 800
            }
        }
    }
}
