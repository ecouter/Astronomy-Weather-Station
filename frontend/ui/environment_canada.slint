import { VerticalBox, Button, HorizontalBox } from "std-widgets.slint";
import { IconButton } from "../../material-1.0/ui/components/icon_button.slint";
import { Icons } from "../../material-1.0/ui/icons/icons.slint";

export component EnvironmentCanadaPage inherits Rectangle {
    background: #1c1c1c;
    height: 720px;
    width: 1280px;
    in property <image> clouds_image;
    in property <image> surface_wind_image;
    in property <image> seeing_image;
    in property <image> temperature_image;
    in property <image> transparency_image;
    in property <image> relative_humidity_image;
    in property <string> clouds_counter;
    in property <string> surface_wind_counter;
    in property <string> seeing_counter;
    in property <string> temperature_counter;
    in property <string> transparency_counter;
    in property <string> relative_humidity_counter;
    in property <string> model_run_info;
    in-out property <bool> show_zoomed_image: false;
    in-out property <image> zoomed_image;
    in-out property <string> zoomed_title;
    callback go_back();
    callback clouds_previous();
    callback clouds_next();
    callback surface_wind_previous();
    callback surface_wind_next();
    callback seeing_previous();
    callback seeing_next();
    callback temperature_previous();
    callback temperature_next();
    callback transparency_previous();
    callback transparency_next();
    callback relative_humidity_previous();
    callback relative_humidity_next();

    VerticalLayout {
        padding-left: 25px;
        padding-right: 35px;
        padding-top: 20px;
        padding-bottom: 20px;
        spacing: 10px;

        // Back button and title
        HorizontalLayout {
            height: 40px;
            Button {
                text: "Back";
                clicked => { go_back(); }
            }
            Text {
                text: "Environment Canada Astro predictions" + (model_run_info != "" ? " (" + model_run_info + ")" : "");
                font-size: 36px;
                color: #ffffff;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }

        // Main content grid
        HorizontalLayout {
            spacing: 100px;

            // Column 1: Clouds and Surface Wind
            VerticalLayout {
                spacing:10px;

                // Clouds navigation buttons
                HorizontalBox {
                    height: 30px;
                    alignment: center;
                    spacing: 0px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            clouds_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            clouds_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Clouds";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: clouds_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: clouds_counter;
                        color: #ff0000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = clouds_image;
                        zoomed_title = "Clouds";
                        show_zoomed_image = true;
                    }
                }

                // Surface Wind navigation buttons
                HorizontalBox {
                    height: 30px;
                    alignment: center;
                    spacing: 0px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            surface_wind_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            surface_wind_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Surface Wind";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: surface_wind_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: surface_wind_counter;
                        color: #ff0000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = surface_wind_image;
                        zoomed_title = "Surface Wind";
                        show_zoomed_image = true;
                    }
                }
            }

            // Column 2: Seeing and Temperature
            VerticalLayout {
                spacing: 10px;

                // Seeing navigation buttons
                HorizontalBox {
                    alignment: center;
                    spacing: 0px;
                    height: 30px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            seeing_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            seeing_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Seeing";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: seeing_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: seeing_counter;
                        color: #ff0000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = seeing_image;
                        zoomed_title = "Seeing";
                        show_zoomed_image = true;
                    }
                }

                // Temperature navigation buttons
                HorizontalBox {
                    alignment: center;
                    spacing: 0px;
                    height: 30px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            temperature_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            temperature_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Temperature";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: temperature_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: temperature_counter;
                        color: #000000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = temperature_image;
                        zoomed_title = "Temperature";
                        show_zoomed_image = true;
                    }
                }
            }

            // Column 3: Transparency and Relative Humidity
            VerticalLayout {
                spacing: 10px;

                // Transparency navigation buttons
                HorizontalBox {
                    height: 30px;
                    alignment: center;
                    spacing: 0px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            transparency_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            transparency_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Transparency";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: transparency_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: transparency_counter;
                        color: #ff0000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = transparency_image;
                        zoomed_title = "Transparency";
                        show_zoomed_image = true;
                    }
                }

                // Relative Humidity navigation buttons
                HorizontalBox {
                    height: 30px;
                    alignment: center;
                    spacing: 0px;

                    IconButton {
                        icon: Icons.chevron_backward;
                        tooltip: "Previous forecast";
                        clicked => {
                            relative_humidity_previous();
                        }
                    }

                    IconButton {
                        icon: Icons.chevron_forward;
                        tooltip: "Next forecast";
                        clicked => {
                            relative_humidity_next();
                        }
                    }

                    // Title
                    Text {
                        text: "Relative Humidity";
                        color: #ffffff;
                        font-size: 24px;
                        font-weight: 600;
                        horizontal-alignment: center;
                        vertical-alignment: top;
                        height: 30px;
                    }
                }

                TouchArea {
                    width: 336px;
                    height: 280px;
                    Image {
                        source: relative_humidity_image;
                        width: 100%;
                        height: 100%;
                        image-fit: fill;
                    }

                    // Counter overlay
                    Text {
                        text: relative_humidity_counter;
                        color: #000000;
                        font-size: 24px;
                        font-weight: 700;
                        horizontal-alignment: left;
                        vertical-alignment: top;
                        x: 10px;
                        y: 10px;
                    }

                    clicked => {
                        zoomed_image = relative_humidity_image;
                        zoomed_title = "Relative Humidity";
                        show_zoomed_image = true;
                    }
                }
            }
        }
    }

    // Zoom overlay
    if show_zoomed_image: Rectangle {
        background: #000000cc; // Semi-transparent black background
        width: 100%;
        height: 100%;

        VerticalLayout {
            alignment: center;
            spacing: 20px;
            padding-left: 40px;

            HorizontalLayout {
                Text {
                    text: zoomed_title;
                    font-size: 48px;
                    color: #ffffff;
                    horizontal-alignment: center;
                }

                Text {
                    text: "Click image to close";
                    font-size: 24px;
                    vertical-alignment: center;
                    color: #ff0000;
                    horizontal-alignment: center;
                }
            }

            TouchArea {
                width: 1200px;
                height: 600px;
                Image {
                    source: zoomed_image;
                    width: 100%;
                    height: 100%;
                    image-fit: contain;
                }
                clicked => {
                    show_zoomed_image = false;
                }
            }
        }
    }
}
